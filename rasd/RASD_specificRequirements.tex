\section{Specific Requirements}

\subsection{Functional Requirements}
The following requirements are derived in order to fulfill the specified goals.
\subsubsection{Goals}
	\begin{description}
		\item \ref{goal:register}\ Allow \emph{guest} users to register to the system
			\begin{enumerate}[label=\textbf{R\arabic*}]
  				\item The system must require the \emph{guest} user to insert a username to identify him
   				\item The system must check that the username inserted by the  \emph{guest} user
   				doesn't belong to another user already registered to the system 
   				\item At the end of the registration phase the system must provide the  \emph{guest}
   				user with a password bound to the username inserted by the  \emph{guest} user that can
   				be used to access the system
   				\item The system must require the  \emph{guest} user to provide his driving license ID
   				code and expiring date during the registration phase
   				\item The system must require the  \emph{guest} user to provide payment information
   				during the registration phase
   				\item The system must require the  \emph{guest} user to provide an email address during
   				the	registration phase
   				\item The system must check that the email inserted by the  \emph{guest} user exists
   				and belongs to him
   				\item The system must require the  \emph{guest} user to insert his name, surname,
   				birth date and place and current domicile in the registration phase
   				\item The system offers an interface to allow the user to modify or update his
   				anagraphical information, payment information, driving license information, email and
   				password (username can't be changed)
  			\end{enumerate}
		\item \ref{goal:login}\ Allow registered users to authenticate to the system
			\begin{enumerate}[resume*]
  				\item The system must require the user to insert his username and password to
  				authenticate to the system
   				\item The system must be able to check if the username and password pair
   				correspond to a user correctly registered to the system
   				\item The system must allow access to the services provided by the system only to
   				authenticated users 
			\end{enumerate}
		\item \ref{goal:position}\ Provide authenticated users with the position of available cars
			\begin{enumerate}[resume*]
				\item The system must be able to identify each car unambiguously
  				\item The system must be able to retrieve the current position of each car
  				\item At each time the system must pair a car with one and only one state; possible
  				states are \emph{Available}, \emph{Not Available}, \emph{Reserved}, \emph{In Use}
   				\item The system must be aware the current state of each car
   				\item The system must be able to know the exact amount of time the car has been in
   				the current state
   				\item The system must be able to show a map with the position of \emph{Available}
   				cars
  				\item The system must be able to identify the position of the user and show it on a
  				map
   				\item The system must be able to calculate the distance of each car from a given
   				position
  			\end{enumerate}
		\item \ref{goal:notifyMaintenance}\ Notify maintenance service with a list of not available
		cars
			\begin{enumerate}[resume*]
   				\item The system must be able to retrieve the current battery level of
   				each car
   				\item If the state of a specific car is set to \emph{Not Available} the
   				system must prevent users from reserving or renting the aforementioned car
   				\item If the state of a specific car is set to \emph{Not Available}, the
   				car must be paired with a brief description of why the car is not
   				available
   				\item The system must offer a restricted access API to retrieve the list of cars marked
   				as \emph{Not Available} along with the description of the problem paired with the
   				state and the current position of each car (\emph{GPS coordinates})
  			\end{enumerate}
		\item \ref{goal:maintenanceDone}\ Provide the maintenance service with a way to notify the system when a car is available again
			\begin{enumerate}[resume*]
   				\item The system must be able to set a specific car state to \emph{Available} in order 
   				to allow users to reserve and rent the aforementioned car
   				\item The system must offer a restricted access API to set the state of a
   				specific car as \emph{Available}
  			\end{enumerate}
  		\item \ref{goal:needMaintenance} Provide the user with a way to contact customer service to report a damaged car
  		\begin{enumerate}[resume*]
  			\item The system must provide information about how to contact customer care
  			service
   			\item The system must allow the customer service to set the state of a
   			specific car to \emph{Not Available}	
  		\end{enumerate}
  		\item \ref{goal:usersHistory}\ Provide a way to show each user's rent and payment history
  			\begin{enumerate}[resume*]
  				\item The system must log an history of all rents and payments
  				\item User's rents history must include expired reservations in which the rent was not completed
  				\item Each record in the payment history of a user, which refers to a ride, must include the ride cost and 
  				the discounts or additional fees applied
  				\item User's payment history must include not completed payment procedures
  				\item The system must be able to show to the user his own history of rents and
  				payments
  			\end{enumerate}
  		\item \ref{goal:banUnbanUsers}\ Provide customer service with a way to ban users in order
  		prevent them from reserving or using other cars, and enable them to use the service again
  			\begin{enumerate}[resume*]
  				\item The system must be able to mark and unmark a user as \emph{banned} 
  				\item The system must require a brief description of the reasons why the user is being marked as 
  				\emph{banned}
  				\item The system must not allow a \emph{banned} user to access the system but only
  				provide him information about how to contact customer service 
  				\item The system must allow customer service to access users' information and
  				history
  				\item The system must allow the customer service to manage the payments
  				of a user: customer service must be able to mark uncompleted ones as completed, to instantiate new payment
  				procedures and to delete pending procedures
   				\item The system must allow the customer service to set the state of a
   				specific user to \emph{banned} or \emph{not banned}
   			\end{enumerate}
 	  	\item \ref{goal:carReservation}\ Allow a user to reserve a car, if available, and hold that
 	  	reservation for an hour
 	  		\begin{enumerate}[resume*]
 	  			\item The system must allow a user to select a specific car in order to reserve it 
 	  			(i.f.f its current state is \emph{Available}), and set to \emph{Reserved} the state of
 	  			the aforementioned car
 	  			\item When the state of a specific car is set to \emph{Reserved}, the car must be
 	  			uniquely paired with the user who made the reservation for the aforementioned car, for
 	  			the duration of the reservation
 	  			\item A car set to \emph{Reserved} remains in this state exactly one hour after the user
 	  			made the reservation; after that time the reservation expires and the system
 	  			must set the state of the aforementioned car to \emph{Available}
 	  			\item The system must not allow a user to make multiple reservations at the same time
   			\end{enumerate}
  		\item \ref{goal:reservationFee}\ Charge the user for 1\euro\ in case he hasn't used the car he reserved after an hour from such reservation
  			\begin{enumerate}[resume*]
  				\item The system must be able to carry out a payment procedure based on payment
  				information provided by the user and on a specific amount of money
  				\item The system must be able to know if a payment procedure is successful or
  				unsuccessful
  				\item The system must ban a user (set to \emph{banned} user) if a
  				payment procedure was unsuccessful and notify him via email that he has to
  				contact customer service
  				\item At each time a user can be paired with one single state of one single car.
  				\item The system must charge the user for 1\euro\ (through a payment procedure) if
  				the car he reserved has been set as \emph{Reserved} paired with the aforementioned
  				user for one hour
   			\end{enumerate}
  		\item \ref{goal:completeRent}\ Allow a user to perform a complete rent: reserving a car, using it and leaving it terminating the rent in a safe area, accomplishing the payment procedure related to aforementioned rent
  			\begin{enumerate}[resume*]
  				\item The system must be able to lock and unlock each car
  				\item The system must be able to know the current motor state of each car
  				(\emph{on} or \emph{off})
  				\item The system must be able to know the current percentage of battery of each car
  				\item The system must be able to unlock a car when the position of the user paired
  				with the
  				\emph{Reserved} state of the car is at most 5 meters away from the position the car
  				\item When the state of a specific car is set to \emph{In Use}, the car must be
 	  			uniquely paired with the user who is using the car
  				\item The system can set the state of a \emph{Reserved} car to \emph{In Use} i.f.f.
  				the user paired with the \emph{Reserved} state of the car has unlocked the car and he
  				has ignited the car engine
  				\item The system must lock a car if no passengers are detected in the car and the car
  				engine is \emph{off}
  				\item When locking  an \emph{In Use} car, the system must be able to activate a timer;
  				only when that timer expires the system must calculate the cost of the last ride
  				performed by the car and charge the user (through a payment procedure) of the calculated
  				amount
  				\item When the timer activated locking a \emph{In Use} car expires the system must
  				set the state of the aforementioned car from \emph{In Use} to \emph{Available}
  				\item The system must set the state of a car from \emph{Available}
  				to \emph{Not Available} if battery percentage is lower than 20\% and the
  				aforementioned car is not plugged in any charging station stating that reason as
  				description
  				\item The system must calculate the base cost of a ride proportionally to the time
  				the car has been used by the aforementioned user (paired as \emph{In Use} with the
  				user)
  				\item When a car is set to \emph{In Use} in every moment the system must show the
  				current cost via the car display (to be payed by the user paired with the \emph{In Use}
  				state of the aforementioned car) 
  				\item The system must be able to identify if a given position is or not inside the sets
  				of safe areas
  				\item When a user is paired with a car which is \emph{In Use} in every moment the
  				system must show him, via the car display, if the aforementioned car position is or
  				isn't inside a safe area
  				\item The system must be able to know the position of all charging stations
  				\item The system must be able to know the state of all charging stations: how many
  				cars are plugged to the station
  				\item The system must be able to know if a car is plugged in a specific charging
  				station
  				\item The system must be able to uniquely identify a charging station and the related
  				plugs
   			\end{enumerate}
  		\item \ref{goal:calculateCost}\ Calculate and charge the user for the correct amount of money he has to pay for his last ride, also considering the various discounts and fees applicable based on the ride
  			\begin{enumerate}[resume*]
  			    \item The system must not cumulate the discounts but must apply only the one with
  			    the highest percentage.
  			    \item The system must be able to know how many passengers are there on a car	
  				\item If locking an \emph{In Use} car the system detects that the car position is not
  				inside a safe area, the system must charge the user paired with the \emph{In Use}
  				state of the aforementioned car for the cost of the ride plus an additional fee; that fee
  				is composed by a fixed amount plus a variable amount proportional to the distance of
  				the car form the nearest safe area
  				\item If a car is located outside the set of safe areas and its state is not \emph{In
  				Use} the system must set the car state to \emph{Not Available} stating that reason
  				as description
  				\item If during the time a car is set as \emph{In Use} the system detects more than
  				one passengers into the car, the system must apply to the user paired with the
  				\emph{In Use} state of the aforementioned car a discount of 10\% of the cost of
  				the current ride
  				\item If locking  a \emph{In Use} car the system detects a level of battery of the
  				aforementioned car greater than 50\%, the system must apply to the user paired with
  				the \emph{In Use} state of the aforementioned car a discount of 20\% of the cost
  				of the last ride
  				\item When the timer activated locking a \emph{In Use} car expires if the system
  				detects the car as plugged into the power grid of a charging station, the system must
  				apply to the user paired with the \emph{In Use} state of the aforementioned car a
  				discount of 30\% of the cost of the last ride
  				\item When the timer activated locking a \emph{In Use} car expires if the system
  				detects the car position is more than 3 KM away from the nearest power grid station
  				or the system detects a level of battery of the aforementioned car lower than 20\%, 
  				the system must charge to the user paired with the \emph{In Use} state of the 
  				aforementioned car the 30\% more on the last ride. 
   			\end{enumerate}
  		\item \ref{goal:moneySavingOption}\ Allow the user to enable a money saving option which provides him with a charging station as destination of the ride to get a discount on the cost of the aforementioned ride
  			\begin{enumerate}[resume*]
  				\item The system must allow the user to enable the \emph{money saving option}
  				\item If the  \emph{money saving option} is enabled the system must allow the user
  				to insert his final destination and provide him information about a station where to
  				leave the car to get a discount
  				\item The system must be able to determine the station suggested to the user by the
  				\emph{money saving option} in order to ensure a uniform distribution of cars in the
  				city
  				\item The system must be able to determine the station suggested to the user by the
  				\emph{money saving option} taking into account the destination of the user and
  				the availability of power plugs at the selected station
  				\item When the timer activated locking a \emph{In Use} car expires if the system
  				detects the car as plugged into the power grid of the charging station determined by
  				the \emph{money saving option} the system must apply to the user paired with the
  				\emph{In Use} state of the aforementioned car a discount on the cost of
  				the current ride		
   			\end{enumerate}
  	\end{description}
  	
\subsection{Performance Requirements}
\subsection{Design Constraints}
\subsection{Software System Attributes}\todo{Da SISTEMARE}
	\subsubsection{Reliability}
	\subsubsection{Availability}
	System must be available 24 hours a day.
	\subsubsection{Security}
	Data must be protected during transmission.
	Restricted access APIs must verify the user who tries to use them.
	\subsubsection{Maintainability}
	\subsubsection{Portability}
	The system must be also accessible by mobile platforms (iOS and Android).

